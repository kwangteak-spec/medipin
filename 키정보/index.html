<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedChecker - ì•½ë¬¼ ì•ˆì „ì„± ê²€ì‚¬</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for a modern look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', 'Malgun Gothic', sans-serif;
            background-color: #f8fafc; /* Light gray background */
        }
        .container-card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .warning {
            border-left: 4px solid #f97316; /* Orange border */
        }
        .caution {
            border-left: 4px solid #facc15; /* Yellow border */
        }
        .safe {
            border-left: 4px solid #10b981; /* Green border */
        }
    </style>
</head>
<body>

    <div class="min-h-screen p-4 sm:p-8">
        <header class="text-center py-6 bg-white rounded-xl container-card mb-8">
            <h1 class="text-3xl font-bold text-gray-800">ğŸ’Š MedChecker: ì²˜ë°© ì•ˆì „ì„± ê²€ì‚¬</h1>
            <p class="text-gray-500 mt-1">ë…¸ì¸ì£¼ì˜ ë° ë³‘ìš© ê¸ˆê¸° ì•½ë¬¼ ìœ„í—˜ì„± í™•ì¸</p>
        </header>

        <main class="max-w-4xl mx-auto space-y-8">
            
            <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="flex border-b border-gray-200">
                <button id="tab-geriatric" onclick="showTab('geriatric')" class="px-4 py-3 text-sm font-medium rounded-t-lg transition-colors duration-200" style="width: 50%;">
                    ë…¸ì¸ì£¼ì˜ ì•½ë¬¼ ê²€ì‚¬
                </button>
                <button id="tab-concurrent" onclick="showTab('concurrent')" class="px-4 py-3 text-sm font-medium rounded-t-lg transition-colors duration-200" style="width: 50%;">
                    ë³‘ìš© ê¸ˆê¸° ì•½ë¬¼ ê²€ì‚¬
                </button>
            </div>

            <!-- 1. ë…¸ì¸ì£¼ì˜ ì•½ë¬¼ ê²€ì‚¬ íƒ­ -->
            <div id="content-geriatric" class="tab-content bg-white p-6 rounded-xl container-card space-y-6">
                <h2 class="text-xl font-semibold text-gray-700">ê³ ë ¹ í™˜ì ì²˜ë°© ì£¼ì˜ í™•ì¸</h2>
                
                <div>
                    <label for="geriatric-drug-name" class="block text-sm font-medium text-gray-700 mb-1">ì•½í’ˆëª… ì…ë ¥ (ì˜ˆ: ë¹…ì†ì •, í´ë¼ë¦¬ìŠ¤ì •)</label>
                    <input type="text" id="geriatric-drug-name" placeholder="ì•½í’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-sky-500 focus:border-sky-500 transition-colors">
                </div>
                
                <button onclick="checkGeriatricRisk()" class="w-full bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-4 rounded-lg transition-colors duration-200 shadow-md">
                    âš ï¸ ë…¸ì¸ ìœ„í—˜ì„± ê²€ì‚¬
                </button>

                <div id="geriatric-results" class="mt-4 p-4 rounded-lg bg-gray-50 min-h-[100px]">
                    <p class="text-gray-500">ê²€ì‚¬ë¥¼ ì‹œì‘í•˜ë ¤ë©´ ì•½í’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”.</p>
                </div>
            </div>

            <!-- 2. ë³‘ìš© ê¸ˆê¸° ì•½ë¬¼ ê²€ì‚¬ íƒ­ -->
            <div id="content-concurrent" class="tab-content bg-white p-6 rounded-xl container-card space-y-6 hidden">
                <h2 class="text-xl font-semibold text-gray-700">ì•½ë¬¼ ìƒí˜¸ì‘ìš©(ë³‘ìš© ê¸ˆê¸°) í™•ì¸</h2>
                
                <div class="flex flex-col sm:flex-row gap-4">
                    <div class="w-full sm:w-1/2">
                        <label for="concurrent-drug1" class="block text-sm font-medium text-gray-700 mb-1">ì²« ë²ˆì§¸ ì•½í’ˆëª… (ì˜ˆ: ì œí´ë¼ì •)</label>
                        <input type="text" id="concurrent-drug1" placeholder="ì•½í’ˆëª… 1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-sky-500 focus:border-sky-500 transition-colors">
                    </div>
                    <div class="w-full sm:w-1/2">
                        <label for="concurrent-drug2" class="block text-sm font-medium text-gray-700 mb-1">ë‘ ë²ˆì§¸ ì•½í’ˆëª… (ì˜ˆ: ì‹¬ë°”ë¡œë“œì •)</label>
                        <input type="text" id="concurrent-drug2" placeholder="ì•½í’ˆëª… 2" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-sky-500 focus:border-sky-500 transition-colors">
                    </div>
                </div>
                
                <button onclick="checkConcurrentRisk()" class="w-full bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-4 rounded-lg transition-colors duration-200 shadow-md">
                    ğŸš« ë³‘ìš© ê¸ˆê¸° ìœ„í—˜ì„± ê²€ì‚¬
                </button>

                <div id="concurrent-results" class="mt-4 p-4 rounded-lg bg-gray-50 min-h-[100px]">
                    <p class="text-gray-500">ë‘ ì•½í’ˆëª…ì„ ëª¨ë‘ ì…ë ¥í•˜ê³  ê²€ì‚¬ë¥¼ ì‹œì‘í•˜ì„¸ìš”.</p>
                </div>
            </div>
            
        </main>
    </div>

    <script>
        // =======================================================
        // ëª¨ì˜(Mock) ë°ì´í„° - ì‹¤ì œ íŒŒì¼(CSV) ëŒ€ì‹  ì‚¬ìš©ë©ë‹ˆë‹¤.
        // =======================================================

        // 1. ë…¸ì¸ ì£¼ì˜ ì•½ë¬¼ ë°ì´í„° (í•œêµ­ì˜ì•½í’ˆì•ˆì „ê´€ë¦¬ì›_ë…¸ì¸ì£¼ì˜ì•½ë¬¼_20240813.csv ê¸°ë°˜)
        const geriatricCautionData = [
            { name: "ë¹…ì†ì •", ingredient: "ethyl loflazepate", caution: "ì¸ì§€ê¸°ëŠ¥ ì €í•˜, ì„¬ë§, ë‚™ìƒ, ê³¨ì ˆ ìœ„í—˜. ì¥ê¸° ì‘ìš© ë²¤ì¡°ë‹¤ì´ì•„ì œí•€ ì‚¬ìš© ì¶”ì²œ ì•ˆí•¨." },
            { name: "ëŒ€ì›ë””ì•„ì œíŒœì£¼ì‚¬ì•¡", ingredient: "diazepam", caution: "ì¸ì§€ê¸°ëŠ¥ ì €í•˜, ì„¬ë§, ë‚™ìƒ, ê³¨ì ˆ ìœ„í—˜. ì¥ê¸° ì‘ìš© ë²¤ì¡°ë‹¤ì´ì•„ì œí•€ ì‚¬ìš© ì¶”ì²œ ì•ˆí•¨." },
            { name: "í´ë¼ë¦¬ìŠ¤ì •", ingredient: "amisulpride", caution: "ì €í˜ˆì••, ì§„ì • ìœ„í—˜ ì•¼ê¸°. ì¹˜ë§¤ ê³ ë ¹í™˜ìì—ê²Œ í•­ì •ì‹ ë³‘ì•½ë¬¼ íˆ¬ì—¬ì‹œ ë‡Œí˜ˆê´€ì§ˆí™˜(ë‡Œì¡¸ì¤‘), ì‚¬ë§ ìœ„í—˜ ì¦ê°€." },
            { name: "ì•„ì¹¸ì†”ì •", ingredient: "amisulpride", caution: "ì €í˜ˆì••, ì§„ì • ìœ„í—˜ ì•¼ê¸°. ì¹˜ë§¤ ê³ ë ¹í™˜ìì—ê²Œ í•­ì •ì‹ ë³‘ì•½ë¬¼ íˆ¬ì—¬ì‹œ ë‡Œí˜ˆê´€ì§ˆí™˜(ë‡Œì¡¸ì¤‘), ì‚¬ë§ ìœ„í—˜ ì¦ê°€." },
            { name: "íƒ€ì´ë ˆë†€", ingredient: "acetaminophen", caution: "ì •ë³´ ì—†ìŒ (ì¼ë°˜ì ì¸ ì²˜ë°© ê°€ì´ë“œë¼ì¸ì— ë”°ë¦„)." } // ì•ˆì „í•œ ì•½ë¬¼ ì˜ˆì‹œ
        ];

        // 2. ë³‘ìš© ê¸ˆê¸° ì•½ë¬¼ ë°ì´í„° (í•œêµ­ì˜ì•½í’ˆì•ˆì „ê´€ë¦¬ì›_ë³‘ìš©ê¸ˆê¸°ì•½ë¬¼_5ì¤„.csv ê¸°ë°˜)
        const concurrentContraindicationData = [
            // clarithromycin + simvastatin
            { drug1: "ì œí´ë¼ì •", drug2: "ì‹¬ë°”ë¡œë“œì •20ë°€ë¦¬ê·¸ëŒ", reason: "ê·¼ë³‘ì¦, íš¡ë¬¸ê·¼ìœµí•´ì˜ ìœ„í—˜ ì¦ê°€" },
            { drug1: "ì œí´ë¼ì •", drug2: "ì‹¬ë°”ìŠ¤íŠ¸ì •20ë°€ë¦¬ê·¸ë¨", reason: "ê·¼ë³‘ì¦, íš¡ë¬¸ê·¼ìœµí•´ì˜ ìœ„í—˜ ì¦ê°€" },
            // ì—­ìˆœ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ë°ì´í„°
            { drug1: "í”„ë¡œìì´ì •", drug2: "ë¦¬ë‚˜ì¹˜ì •", reason: "ì¤‘ì¶”ì‹ ê²½ê³„ ë¶€ì‘ìš© ìœ„í—˜ ì¦ê°€" }, 
            { drug1: "ë¦¬ë‚˜ì¹˜ì •", drug2: "í”„ë¡œìì´ì •", reason: "ì¤‘ì¶”ì‹ ê²½ê³„ ë¶€ì‘ìš© ìœ„í—˜ ì¦ê°€" } 
        ];

        // =======================================================
        // UI ë¡œì§
        // =======================================================

        document.addEventListener('DOMContentLoaded', () => {
            // ì´ˆê¸° íƒ­ ì„¤ì •
            showTab('geriatric'); 
        });

        /**
         * íƒ­ ì „í™˜ ê¸°ëŠ¥
         * @param {string} tabName - 'geriatric' ë˜ëŠ” 'concurrent'
         */
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('button[id^="tab-"]').forEach(btn => 
                btn.classList.remove('text-sky-600', 'border-sky-600', 'bg-sky-50', 'border-b-2', 'font-semibold')
            );

            const content = document.getElementById(`content-${tabName}`);
            const button = document.getElementById(`tab-${tabName}`);

            if (content && button) {
                content.classList.remove('hidden');
                button.classList.add('text-sky-600', 'border-sky-600', 'bg-sky-50', 'border-b-2', 'font-semibold');
            }
        }


        // =======================================================
        // 1. ë…¸ì¸ ì£¼ì˜ ì•½ë¬¼ ê²€ì‚¬ ë¡œì§
        // =======================================================

        function checkGeriatricRisk() {
            const drugNameInput = document.getElementById('geriatric-drug-name').value.trim();